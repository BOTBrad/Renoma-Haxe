(function(G){function y(){this.u=[];this.Ma(-1)}function D(a,c){this.width=a;this.height=c;this.za=[]}function H(){this.frames=0}function I(){}function J(a){this.context=a;this.sb=20;this.G=[]}function m(){}function da(){}function l(){}function z(a){this.zb=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,z)}function g(a,c,b){this.x=a;this.y=c;this.z=b}function K(a,c){this.x=a;this.y=c}function L(a,c,b,d){this.R=a;this.x=c;this.y=b;this.z=d}function u(a,c,b,d,e,f,p,v,
g){this.b=a;this.h=c;this.c=b;this.f=d;this.m11=e;this.m21=f;this.g=p;this.m12=v;this.m22=g}function S(){}function M(a,c,b,d){this.x=a;this.y=c;this.width=b;this.height=d}function E(){}function q(a,c,b,d,e){null==e&&(e=-1);this.left=a;this.key=c;this.value=b;this.right=d;this.B=-1==e?(function(a){a=a.left;return null==a?0:a.B}(this)>function(a){a=a.right;return null==a?0:a.B}(this)?function(a){a=a.left;return null==a?0:a.B}(this):function(a){a=a.right;return null==a?0:a.B}(this))+1:e}function N(){}
function T(a){var c=this;this.id=setInterval(function(){c.pa()},a)}function ja(){}function U(a){this.u=[];for(var c=0,b=a.u.length;c<b;){var d=c++;this.u.push(new x(a,d))}}function A(a,c){this.ib=a==h.I||a==h.D;this.Bb=a==h.N||a==h.I;this.C=[];this.C.push({s:c.start,type:r.S});this.C.push({s:c.stop,type:r.S})}function x(a,c){this.L=c;this.floor=x.F(a.u[c]);this.G=[];this.na=[];this.Za(a)}function V(a,c,b){this.La=a;this.sa=c;this.ra=b}function B(a,c){this.origin=a;this.ea=c}function W(a,c,b){this.l=
new g(a,c,1);this.Ia=b}function X(a,c){this.start=a;this.stop=c}function Y(a,c,b){this.origin=a;this.O=c;this.P=b}function O(a){F.call(this,new W(0,0,.3),a,5,Math.PI)}function F(a,c,b,d){this.v=a;this.L=c;this.heading=0;this.speed=b;this.ub=d}function Z(a,c,b,d){this.ua=a;this.controller=c;this.Pa=b;this.Ka=d;this.Z=new aa(a.ja);this.A=new O(a.ja)}function fa(){}function P(){}function ba(){this.W=new ca}function ca(){this.y=this.x=0;this.Da=.1}function aa(a,c){null==c&&(c=6);this.jb=106;this.L=a;
this.position=new g(0,0,1);this.speed=c}function k(a){this.ma=a}function C(){}function ga(){}function ha(){}function w(){return l.o(this,"")}function ia(a,c){function b(){}b.prototype=a;var d=new b,e;for(e in c)d[e]=c[e];c.toString!==Object.prototype.toString&&(d.toString=c.toString);return d}ha.a=!0;ha.Sa=function(a){return{Ca:0,wa:a,gb:function(){return this.Ca<this.wa.length},next:function(){return this.wa[this.Ca++]}}};ga.a=!0;ga.Ta=function(){var a=I.Qa();a.U();var c=new T(33);c.pa=function(){a.update();
a.rb()};c.pa()};Math.a=!0;C.a=!0;C.compare=function(a,c){return a==c?0:a>c?1:-1};C.da=function(a){return null!=a&&null!=a.m};var t={T:!0,va:["None","Some"],M:["None",0]};t.M.toString=w;t.M.m=t;t.fa=function(a){a=["Some",1,a];a.m=t;a.toString=w;return a};k.a=!0;k.da=function(a){return new k(t.fa(a))};k.F=function(){return new k(t.M)};k.w=function(a){return new k(t.fa(a))};k.o=function(){return new k(t.M)};k.K=function(){return new k(t.M)};k.ca=function(a){return new k(t.fa(a))};k.aa=function(){return new k(t.M)};
k.prototype={cb:function(a){var c=this.ma;switch(c[1]){case 0:return k.aa();case 1:return k.ca(a(c[2]))}},$a:function(a){var c=this.ma;switch(c[1]){case 0:return k.K();case 1:return a(c[2])}},raw:function(){return this.ma},i:k};aa.a=!0;aa.prototype={move:function(a,c){var b=this.position,d=new g(a.x,a.y,a.z);d.x-=b.x;d.y-=b.y;d.z-=b.z;Math.sqrt(d.x*d.x+d.y*d.y+d.z*d.z)<this.speed*c||(b=Math.sqrt(d.x*d.x+d.y*d.y+d.z*d.z),0<b&&(d.x/=b,d.y/=b,d.z/=b,d),b=this.speed,d=new g(d.x,d.y,d.z),d.x*=b,d.y*=b,
d.z*=b,d=new g(d.x,d.y,d.z),d.x*=c,d.y*=c,d.z*=c);b=this.position;b=new g(b.x,b.y,b.z);b.x+=d.x;b.y+=d.y;b.z+=d.z;this.position=b},eb:function(a){var c=this.jb/2,b=new g(0,0,1),d=this.position;a=new g(a.x,a.y,a.z);a.x-=d.x;a.y-=d.y;a.z-=d.z;var d=Math.PI/180*c,e=Math.sin(d/2),d=new L(Math.cos(d/2),e*b.x,e*b.y,e*b.z),e=2*(d.x*a.x+d.y*a.y+d.z*a.z),f=d.R*d.R-d.x*d.x-d.y*d.y-d.z*d.z,p=2*d.R,c=Math.PI/180*-c,v=Math.sin(c/2),b=new L(Math.cos(c/2),v*b.x,v*b.y,v*b.z),c=2*(b.x*a.x+b.y*a.y+b.z*a.z),v=b.R*b.R-
b.x*b.x-b.y*b.y-b.z*b.z,ea=2*b.R;return Q.Ba(this.position,new g(e*d.x+f*a.x+p*(d.y*a.z-d.z*a.y),e*d.y+f*a.y+p*(d.z*a.x-d.x*a.z),e*d.z+f*a.z+p*(d.x*a.y-d.y*a.x)),new g(c*b.x+v*a.x+ea*(b.y*a.z-b.z*a.y),c*b.y+v*a.y+ea*(b.z*a.x-b.x*a.z),c*b.z+v*a.z+ea*(b.x*a.y-b.y*a.x)))},i:aa};ca.a=!0;ca.prototype={Na:function(a){return this.x=a},Oa:function(a){return this.y=a},ka:function(){return this.Ea(this.x)},ba:function(){return this.Ea(this.y)},Ea:function(a){a=a-this.Da*da.sign(a);return a/=1-this.Da},i:ca};
ba.a=!0;ba.prototype={i:ba};P.a=!0;P.prototype={i:P};fa.a=!0;fa.Y=[P];Z.a=!0;Z.prototype={U:function(){this.Pa.U(this);this.Ka.U(this);return this},update:function(){this.Pa.oa(this,.033);return this},rb:function(){this.Ka.oa(this,.033);return this},i:Z};F.a=!0;F.prototype={move:function(a,c){this.rotate(a.ka()*c*this.ub);this.v.l.x+=a.ba()*c*this.speed*Math.cos(this.heading);this.v.l.y+=a.ba()*c*this.speed*Math.sin(this.heading)},rotate:function(a){this.heading=(this.heading-a)%(2*Math.PI)},ka:function(){return this.v.l.x},
ba:function(){return this.v.l.y},i:F};O.a=!0;O.ia=F;O.prototype=ia(F.prototype,{i:O});Y.a=!0;Y.prototype={i:Y};var Q={a:!0,j:function(a,c,b){return new Y(a,c,b)},Ba:function(a,c,b){a=Q.j(a,c,b);c=a.O;b=a.P;b=new g(b.x,b.y,b.z);var d=b.z*c.x-b.x*c.z,e=b.x*c.y-b.y*c.x;b.x=b.y*c.z-b.z*c.y;b.y=d;b.z=e;return 0<b.z?k.da(a):k.F()},lb:function(a,c){var b=a.origin,d=c.stop,e=new g(d.x,d.y,d.z);e.x-=b.x;e.y-=b.y;e.z-=b.z;var b=a.origin,d=c.start,f=new g(d.x,d.y,d.z);f.x-=b.x;f.y-=b.y;f.z-=b.z;if(0>function(){var b=
a.P,b=new g(b.x,b.y,b.z),c=b.z*e.x-b.x*e.z,d=b.x*e.y-b.y*e.x;b.x=b.y*e.z-b.z*e.y;b.y=c;b.z=d;return b}(this).z&&0>function(){var b=a.O,c=new g(f.x,f.y,f.z),d=c.z*b.x-c.x*b.z,e=c.x*b.y-c.y*b.x;c.x=c.y*b.z-c.z*b.y;c.y=d;c.z=e;return c}(this).z)return k.F();b=0<function(){var b=a.O,b=new g(b.x,b.y,b.z),c=b.z*e.x-b.x*e.z,d=b.x*e.y-b.y*e.x;b.x=b.y*e.z-b.z*e.y;b.y=c;b.z=d;return b}(this).z?a.O:e;d=0>function(){var b=a.P,b=new g(b.x,b.y,b.z),c=b.z*f.x-b.x*f.z,d=b.x*f.y-b.y*f.x;b.x=b.y*f.z-b.z*f.y;b.y=c;
b.z=d;return b}(this).z?a.P:f;return Q.Ba(a.origin,b,d)},$:function(a,c){return B.o(a.origin,a.P).$(c).$a(function(b){var c=a.O;return B.o(a.origin,new g(-c.x,-c.y,-c.z)).$(b)})}};X.a=!0;X.prototype={i:X};var n={a:!0,j:function(a,c){return new X(a,c)},Ga:function(a){var c=a.stop;a=a.start;a=new g(a.x,a.y,a.z);a.x-=c.x;a.y-=c.y;a.z-=c.z;return Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)},normalize:function(a){var c=1/n.Ga(a);return n.j(a.start,function(){var b=a.start,d=a.stop,d=new g(d.x,d.y,d.z);d.x-=b.x;
d.y-=b.y;d.z-=b.z;b=new g(d.x,d.y,d.z);b.x*=c;b.y*=c;b.z*=c;d=a.start;d=new g(d.x,d.y,d.z);d.x+=b.x;d.y+=b.y;d.z+=b.z;return d}(this))},ob:function(a,c){var b=a.start,d=a.stop,e=new g(d.x,d.y,d.z);e.x-=b.x;e.y-=b.y;e.z-=b.z;var f=e.x*e.x+e.y*e.y+e.z*e.z;if(0==f)return k.o();var p;p=function(){var a=new g(c.x,c.y,c.z);a.x-=b.x;a.y-=b.y;a.z-=b.z;return a.x*e.x+a.y*e.y+a.z*e.z}(this)/f;d=0>=p?n.j(b,c):1<=p?n.j(d,c):n.j(function(){var a=new g(e.x,e.y,e.z);a.x*=p;a.y*=p;a.z*=p;var c=new g(b.x,b.y,b.z);
c.x+=a.x;c.y+=a.y;c.z+=a.z;return c}(this),c);return k.w(d)}};W.a=!0;W.prototype={hb:function(a){var c;a=n.ob(a,this.l).raw();switch(a[1]){case 0:return k.o();case 1:c=a[2]}var b=n.Ga(c);return b>this.Ia?k.o():k.w(function(a){var e=a.Ia-b,f=n.normalize(c);return n.j(f.start,function(){var a=f.start,b=f.stop,b=new g(b.x,b.y,b.z);b.x-=a.x;b.y-=a.y;b.z-=a.z;a=new g(b.x,b.y,b.z);a.x*=e;a.y*=e;a.z*=e;b=f.start;b=new g(b.x,b.y,b.z);b.x+=a.x;b.y+=a.y;b.z+=a.z;return b}(a))}(this))},i:W};B.a=!0;B.o=function(a,
c){return new B(a,new g(-c.y,c.x,0))};B.prototype={$:function(a){var c;c=0>function(b){var c=b.ea;b=b.origin;var d=a.start,d=new g(d.x,d.y,d.z);d.x-=b.x;d.y-=b.y;d.z-=b.z;return c.x*d.x+c.y*d.y+c.z*d.z}(this);var b;b=0>function(b){var c=b.ea;b=b.origin;var d=a.stop,d=new g(d.x,d.y,d.z);d.x-=b.x;d.y-=b.y;d.z-=b.z;return c.x*d.x+c.y*d.y+c.z*d.z}(this);if(c&&b)return k.o();if(!c&&!b)return k.w(a);var d=a.start,e=a.stop,f=new g(e.x,e.y,e.z);f.x-=d.x;f.y-=d.y;f.z-=d.z;e=function(b){var c=b.ea,d=a.start;
b=b.origin;b=new g(b.x,b.y,b.z);b.x-=d.x;b.y-=d.y;b.z-=d.z;return c.x*b.x+c.y*b.y+c.z*b.z}(this)/function(b){b=b.ea;return b.x*f.x+b.y*f.y+b.z*f.z}(this);d=new g(f.x,f.y,f.z);d.x*=e;d.y*=e;d.z*=e;e=a.start;e=new g(e.x,e.y,e.z);e.x+=d.x;e.y+=d.y;e.z+=d.z;if(c)return k.w(n.j(e,a.stop));if(b)return k.w(n.j(a.start,e));G.log("This should never be hit");return k.o()},i:B};V.a=!0;V.prototype={i:V};x.a=!0;x.F=function(a){return new M(-a.width/2,-a.height/2,a.width,a.height)};x.K=function(a){var c=a.height/
2,b=a.width/2;a=new E;var d=new A(h.I,n.j(new g(b,c,1),new g(-b,c,1)));a.set(h.I,d);d=new A(h.D,n.j(new g(-b,-c,1),new g(b,-c,1)));a.set(h.D,d);d=new A(h.H,n.j(new g(b,-c,1),new g(b,c,1)));a.set(h.H,d);c=new A(h.N,n.j(new g(-b,c,1),new g(-b,-c,1)));a.set(h.N,c);return a};x.prototype={Za:function(a){for(var c=a.u[this.L],b=x.K(c),d=0,c=c.za;d<c.length;){var e=c[d];++d;var f=this.fb(a,e);b.get(e.direction).Xa(f.La);this.na.push(f)}for(a=b.iterator();a.gb();)b=a.next(),this.G=this.G.concat(b.bb())},
fb:function(a,c){var b=a.u[this.L],d=a.u[c.Ha],e=new g(0,0,0),f,p,h=b.width/2,b=b.height/2,k=d.width/2,d=d.height/2;switch(c.direction[1]){case 0:e.y=b+d;f=new g(Math.min(h,k),b,1);p=new g(Math.max(-h,-k),b,1);break;case 1:e.y=-(b+d);f=new g(Math.max(-h,-k),-b,1);p=new g(Math.min(h,k),-b,1);break;case 2:e.x=h+k;f=new g(h,Math.max(-b,-d),1);p=new g(h,Math.min(b,d),1);break;case 3:e.x=-(h+k),f=new g(-h,Math.min(b,d),1),p=new g(-h,Math.max(-b,-d),1)}return new V(n.j(f,p),m.Va(e),c.Ha)},i:x};var r={T:!0,
va:["WallPoint","StartPortal","StopPortal"],S:["WallPoint",0]};r.S.toString=w;r.S.m=r;r.ga=["StartPortal",1];r.ga.toString=w;r.ga.m=r;r.ha=["StopPortal",2];r.ha.toString=w;r.ha.m=r;A.a=!0;A.prototype={Xa:function(a){this.C.push({s:a.start,type:r.ga});this.C.push({s:a.stop,type:r.ha})},bb:function(){this.C.sort(this.ib?function(b,a){return b.s.x<a.s.x?-1:b.s.x>a.s.x?1:0}:function(b,a){return b.s.y<a.s.y?-1:b.s.y>a.s.y?1:0});var a=[],c=!1,b=0;try{for(;b<this.C.length;){var d=this.C[b];switch(d.type[1]){case 0:var e=
d.s;c||a.push(e);b++;throw"__break__";case 1:c=!c;break;case 2:c=!c}b++}}catch(R){if("__break__"!=R)throw R;}d=r.S;try{for(;b<this.C.length;){var f=this.C[b],g=f.type;switch(f.type[1]){case 0:var h=f.s;c||a.push(h);throw"__break__";default:var k=f.s;g==d?G.log("Overlapping portals!"):(c=!c,a.push(k))}b++}}catch(R){if("__break__"!=R)throw R;}this.Bb&&a.reverse();0!=a.length%2&&G.log("we have an odd number of stops");c=[];b=0;for(f=a.length/2|0;b<f;)g=b++,c.push(n.j(a[2*g],a[2*g+1]));return c},i:A};
U.a=!0;U.prototype={i:U};ja.a=!0;T.a=!0;T.prototype={pa:function(){},i:T};N.a=!0;N.prototype={set:function(a,c){this.root=this.qa(a,c,this.root)},get:function(a){for(var c=this.root;null!=c;){var b=this.compare(a,c.key);if(0==b)return c.value;c=0>b?c.left:c.right}return null},iterator:function(){var a=[];this.la(this.root,a);return ha.Sa(a)},qa:function(a,c,b){if(null==b)return new q(null,a,c,null);var d=this.compare(a,b.key);if(0==d)return new q(b.left,a,c,b.right,null==b?0:b.B);if(0>d)return a=
this.qa(a,c,b.left),this.xa(a,b.key,b.value,b.right);a=this.qa(a,c,b.right);return this.xa(b.left,b.key,b.value,a)},la:function(a,c){null!=a&&(this.la(a.left,c),c.push(a.value),this.la(a.right,c))},xa:function(a,c,b,d){var e;null==a?e=0:e=a.B;var f;null==d?f=0:f=d.B;return e>f+2?function(){var b=a.left;return null==b?0:b.B}(this)>=function(){var b=a.right;return null==b?0:b.B}(this)?new q(a.left,a.key,a.value,new q(a.right,c,b,d)):new q(new q(a.left,a.key,a.value,a.right.left),a.right.key,a.right.value,
new q(a.right.right,c,b,d)):f>e+2?function(){var b=d.right;return null==b?0:b.B}(this)>function(){var b=d.left;return null==b?0:b.B}(this)?new q(new q(a,c,b,d.left),d.key,d.value,d.right):new q(new q(a,c,b,d.left.left),d.left.key,d.left.value,new q(d.left.right,d.key,d.value,d.right)):new q(a,c,b,d,(e>f?e:f)+1)},compare:function(a,c){return C.compare(a,c)},i:N};q.a=!0;q.prototype={i:q};E.a=!0;E.Y=[ja];E.ia=N;E.prototype=ia(N.prototype,{compare:function(a,c){var b=a[1]-c[1];if(0!=b)return b;var b=
a.slice(2),d=c.slice(2);return 0==b.length&&0==d.length?0:this.ya(b,d)},ya:function(a,c){var b=a.length-c.length;if(0!=b)return b;for(var b=0,d=a.length;b<d;){var e=b++,e=this.ab(a[e],c[e]);if(0!=e)return e}return 0},ab:function(a,c){return C.da(a)&&C.da(c)?this.compare(a,c):a instanceof Array&&null==a.m&&c instanceof Array&&null==c.m?this.ya(a,c):C.compare(a,c)},i:E});M.a=!0;M.prototype={Aa:function(a){return S.ca(this.x,this.width,a.x)&&S.ca(this.y,this.height,a.y)},Fa:function(a){var c=new K(this.x,
this.y);switch(a){case 0:break;case 1:c.x+=this.width;break;case 2:c.x+=this.width;c.y+=this.height;break;case 3:c.y+=this.height;break;default:throw new z("Invalid vertex index.");}return c},i:M};S.a=!0;S.ca=function(a,c,b){return b>=a&&b<=a+c};u.a=!0;u.prototype={i:u};L.a=!0;L.prototype={i:L};K.a=!0;K.prototype={i:K};g.a=!0;g.prototype={i:g};z.a=!0;z.ia=Error;z.prototype=ia(Error.prototype,{i:z});l.a=!0;l.Ab=function(a){if(a instanceof Array&&null==a.m)return Array;var c=a.i;if(null!=c)return c;
a=l.aa(a);return null!=a?l.pb(a):null};l.o=function(a,c){if(null==a)return"null";if(5<=c.length)return"<...>";var b=typeof a;"function"==b&&(a.a||a.T)&&(b="object");switch(b){case "object":if(a instanceof Array){if(a.m){if(2==a.length)return a[0];b=a[0]+"(";c+="\t";for(var d=2,e=a.length;d<e;){var f=d++;2!=f?b+=","+l.o(a[f],c):b+=l.o(a[f],c)}return b+")"}b=a.length;d="[";c+="\t";for(e=0;e<b;)f=e++,d+=(0<f?",":"")+l.o(a[f],c);return d+"]"}try{d=a.toString}catch(g){return g instanceof z&&(g=g.zb),"???"}if(null!=
d&&d!=Object.toString&&"function"==typeof d&&(b=a.toString(),"[object Object]"!=b))return b;b=null;d="{\n";c+="\t";e=null!=a.hasOwnProperty;for(b in a)e&&!a.hasOwnProperty(b)||"prototype"==b||"__class__"==b||"__super__"==b||"__interfaces__"==b||"__properties__"==b||(2!=d.length&&(d+=", \n"),d+=c+b+" : "+l.o(a[b],c));c=c.substring(1);return d+("\n"+c+"}");case "function":return"<function>";case "string":return a;default:return String(a)}};l.F=function(a,c){if(null==a)return!1;if(a==c)return!0;var b=
a.Y;if(null!=b)for(var d=0,e=b.length;d<e;){var f=d++,f=b[f];if(f==c||l.F(f,c))return!0}return l.F(a.ia,c)};l.mb=function(a){var c=KeyboardEvent;if(null==c)return!1;switch(c){case ma:return(a|0)===a;case ka:return"number"==typeof a;case la:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.m;case na:return!0;default:if(null!=a)if("function"==typeof c){if(a instanceof c||l.F(l.Ab(a),c))return!0}else{if("object"==typeof c&&l.nb(c)&&a instanceof
c)return!0}else return!1;return c==oa&&null!=a.a||c==pa&&null!=a.T?!0:a.m==c}};l.aa=function(a){a=l.qb.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};l.nb=function(a){return null!=l.aa(a)};l.pb=function(a){return Function("return typeof "+a+' != "undefined" ? '+a+" : null")()};da.a=!0;da.sign=function(a){return 0>a?-1:0<a?1:0};m.a=!0;m.w=function(){var a=new u(1,0,0,0,1,0,0,0,1);return new u(a.b,a.h,a.c,a.f,a.m11,a.m21,a.g,a.m12,a.m22)};m.K=function(a,c){var b=
m.w();b.c=a;b.m21=c;return b};m.Va=function(a){return m.K(a.x,a.y)};m.yb=function(){var a=m.w();a.b=10;a.m11=10;return a};m.Ua=function(){var a=m.w();a.b=1;a.m11=-1;return a};m.Wa=function(a,c){var b=c.Fa(0),d=c.Fa(2),b=new g(b.x,b.y,1),b=new g(a.b*b.x+a.h*b.y+a.c*b.z,a.f*b.x+a.m11*b.y+a.m21*b.z,a.g*b.x+a.m12*b.y+a.m22*b.z),d=new g(d.x,d.y,1),d=new g(a.b*d.x+a.h*d.y+a.c*d.z,a.f*d.x+a.m11*d.y+a.m21*d.z,a.g*d.x+a.m12*d.y+a.m22*d.z);return new M(b.x,b.y,d.x-b.x,d.y-b.y)};m.Ra=function(a){a=new u(a.b,
a.h,a.c,a.f,a.m11,a.m21,a.g,a.m12,a.m22);a.b=1/a.b;a.m11=1/a.m11;a.c=-a.c;a.m21=-a.m21;return a};J.a=!0;J.Y=[P];J.prototype={U:function(a){this.X=a.X},oa:function(a){this.context.clearRect(0,0,854,480);var c;c=m.K(427,240);var b=m.Ua();c=new u(c.b*b.b+c.h*b.f+c.c*b.g,c.b*b.h+c.h*b.m11+c.c*b.m12,c.b*b.c+c.h*b.m21+c.c*b.m22,c.f*b.b+c.m11*b.f+c.m21*b.g,c.f*b.h+c.m11*b.m11+c.m21*b.m12,c.f*b.c+c.m11*b.m21+c.m21*b.m22,c.g*b.b+c.m12*b.f+c.m22*b.g,c.g*b.h+c.m12*b.m11+c.m22*b.m12,c.g*b.c+c.m12*b.m21+c.m22*
b.m22);b=m.yb();c=new u(c.b*b.b+c.h*b.f+c.c*b.g,c.b*b.h+c.h*b.m11+c.c*b.m12,c.b*b.c+c.h*b.m21+c.c*b.m22,c.f*b.b+c.m11*b.f+c.m21*b.g,c.f*b.h+c.m11*b.m11+c.m21*b.m12,c.f*b.c+c.m11*b.m21+c.m21*b.m22,c.g*b.b+c.m12*b.f+c.m22*b.g,c.g*b.h+c.m12*b.m11+c.m22*b.m12,c.g*b.c+c.m12*b.m21+c.m22*b.m22);b=m.K(-a.A.ka(),-a.A.ba());this.V=new u(c.b*b.b+c.h*b.f+c.c*b.g,c.b*b.h+c.h*b.m11+c.c*b.m12,c.b*b.c+c.h*b.m21+c.c*b.m22,c.f*b.b+c.m11*b.f+c.m21*b.g,c.f*b.h+c.m11*b.m11+c.m21*b.m12,c.f*b.c+c.m11*b.m21+c.m21*b.m22,
c.g*b.b+c.m12*b.f+c.m22*b.g,c.g*b.h+c.m12*b.m11+c.m22*b.m12,c.g*b.c+c.m12*b.m21+c.m22*b.m22);this.Ja(a.Z.eb(a.A.v.l),a.A.L,m.w(),a.A);this.context.strokeStyle="#000000";this.context.beginPath();a=0;for(c=this.G;a<c.length;){b=c[a];++a;var d;d=this.V;var e=b.start;d=new g(d.b*e.x+d.h*e.y+d.c*e.z,d.f*e.x+d.m11*e.y+d.m21*e.z,d.g*e.x+d.m12*e.y+d.m22*e.z);e=this.V;b=b.stop;b=new g(e.b*b.x+e.h*b.y+e.c*b.z,e.f*b.x+e.m11*b.y+e.m21*b.z,e.g*b.x+e.m12*b.y+e.m22*b.z);this.context.moveTo(d.x,d.y);this.context.lineTo(b.x,
b.y)}this.context.stroke();this.G=[]},Ja:function(a,c,b,d){var e=this,f;a=a.raw();switch(a[1]){case 0:return;case 1:f=a[2]}this.tb(f,b);if(!(function(){var a=new g(0,0,1),c=f.origin,a=new g(b.b*a.x+b.h*a.y+b.c*a.z,b.f*a.x+b.m11*a.y+b.m21*a.z,b.g*a.x+b.m12*a.y+b.m22*a.z),a=new g(a.x,a.y,a.z);a.x-=c.x;a.y-=c.y;a.z-=c.z;return Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)}(this)>this.sb)){a=0;for(var h=this.X.u[c].G;a<h.length;){var k=h[a];++a;Q.$(f,n.j(function(){var a=k.start;return new g(b.b*a.x+b.h*a.y+b.c*
a.z,b.f*a.x+b.m11*a.y+b.m21*a.z,b.g*a.x+b.m12*a.y+b.m22*a.z)}(this),function(){var a=k.stop;return new g(b.b*a.x+b.h*a.y+b.c*a.z,b.f*a.x+b.m11*a.y+b.m21*a.z,b.g*a.x+b.m12*a.y+b.m22*a.z)}(this))).cb(function(a){e.G.push(a)})}a=0;for(c=this.X.u[c].na;a<c.length;){var l=c[a];++a;this.Ja(Q.lb(f,function(a){var c=l.La;return n.j(function(){var a=c.start;return new g(b.b*a.x+b.h*a.y+b.c*a.z,b.f*a.x+b.m11*a.y+b.m21*a.z,b.g*a.x+b.m12*a.y+b.m22*a.z)}(a),function(){var a=c.stop;return new g(b.b*a.x+b.h*a.y+
b.c*a.z,b.f*a.x+b.m11*a.y+b.m21*a.z,b.g*a.x+b.m12*a.y+b.m22*a.z)}(a))}(this)),l.ra,function(){var a=l.sa;return new u(b.b*a.b+b.h*a.f+b.c*a.g,b.b*a.h+b.h*a.m11+b.c*a.m12,b.b*a.c+b.h*a.m21+b.c*a.m22,b.f*a.b+b.m11*a.f+b.m21*a.g,b.f*a.h+b.m11*a.m11+b.m21*a.m12,b.f*a.c+b.m11*a.m21+b.m21*a.m22,b.g*a.b+b.m12*a.f+b.m22*a.g,b.g*a.h+b.m12*a.m11+b.m22*a.m12,b.g*a.c+b.m12*a.m21+b.m22*a.m22)}(this),d)}}},tb:function(a){var c;c=this.V;var b=a.P,b=new g(b.x,b.y,b.z);b.x*=100;b.y*=100;b.z*=100;var d=a.origin,d=
new g(d.x,d.y,d.z);d.x+=b.x;d.y+=b.y;d.z+=b.z;c=new g(c.b*d.x+c.h*d.y+c.c*d.z,c.f*d.x+c.m11*d.y+c.m21*d.z,c.g*d.x+c.m12*d.y+c.m22*d.z);b=this.V;d=a.O;d=new g(d.x,d.y,d.z);d.x*=100;d.y*=100;d.z*=100;var e=a.origin,e=new g(e.x,e.y,e.z);e.x+=d.x;e.y+=d.y;e.z+=d.z;b=new g(b.b*e.x+b.h*e.y+b.c*e.z,b.f*e.x+b.m11*e.y+b.m21*e.z,b.g*e.x+b.m12*e.y+b.m22*e.z);d=this.V;a=a.origin;a=new g(d.b*a.x+d.h*a.y+d.c*a.z,d.f*a.x+d.m11*a.y+d.m21*a.z,d.g*a.x+d.m12*a.y+d.m22*a.z);this.context.strokeStyle="#6666FF";this.context.beginPath();
this.context.moveTo(c.x,c.y);this.context.lineTo(a.x,a.y);this.context.lineTo(b.x,b.y);this.context.stroke()},i:J};I.a=!0;I.Qa=function(){var a=window.document.createElement("canvas");a.width=854;a.height=480;window.document.body.appendChild(a);return new Z(I.ua(),new ba,new H,new J(a.getContext("2d",null)))};I.ua=function(){for(var a=new y,c=0;4>c;){var b=c++;a.Ya(D.w(5+2*b%3,5+b%3))}a.J(0,1,h.H);a.J(1,2,h.H);a.J(1,3,h.D);a.J(3,2,h.D);a.Ma(1);return a};H.a=!0;H.Y=[fa];H.prototype={U:function(a){this.kb(a);
a.X=new U(a.ua)},oa:function(a,c){this.xb(a,c);this.wb(a,c);this.frames++},xb:function(a,c){var b=a.A,d=a.X.u,e=d[a.A.L];b.move(a.controller.W,c);for(var f=b.v,h=0,k=e.G;h<k.length;){var l=k[h];++h;l=f.hb(l).raw();switch(l[1]){case 1:l=l[2],f.l.x+=l.stop.x-l.start.x,f.l.y+=l.stop.y-l.start.y}}f=new K(a.A.v.l.x,a.A.v.l.y);if(!e.floor.Aa(f))for(h=0,k=e.na;h<k.length;)if(e=k[h],++h,m.Wa(e.sa,d[e.ra].floor).Aa(f)){d=m.Ra(e.sa);b.L=e.ra;e=b.v.l;b.v.l=new g(d.b*e.x+d.h*e.y+d.c*e.z,d.f*e.x+d.m11*e.y+d.m21*
e.z,d.g*e.x+d.m12*e.y+d.m22*e.z);b=a.Z.position;a.Z.position=new g(d.b*b.x+d.h*b.y+d.c*b.z,d.f*b.x+d.m11*b.y+d.m21*b.z,d.g*b.x+d.m12*b.y+d.m22*b.z);break}},wb:function(a,c){var b=new g(Math.cos(a.A.heading),Math.sin(a.A.heading),0),b=new g(b.x,b.y,b.z);b.x*=2;b.y*=2;b.z*=2;var d=a.A.v.l,d=new g(d.x,d.y,d.z);d.x-=b.x;d.y-=b.y;d.z-=b.z;a.Z.move(d,c)},kb:function(a){function c(b){if(l.mb(b)){var c;c="keydown"==b.type?1:0;switch(b.keyCode){case 87:a.controller.W.Oa(c);break;case 83:a.controller.W.Oa(-c);
break;case 65:a.controller.W.Na(-c);break;case 68:a.controller.W.Na(c)}}}window.document.body.addEventListener("keydown",c,!1);window.document.body.addEventListener("keyup",c,!1)},i:H};D.a=!0;D.w=function(a,c){return new D(a,c)};D.prototype={J:function(a,c){this.za.push({direction:c,Ha:a})},i:D};var h={T:!0,va:["North","South","East","West"],I:["North",0]};h.I.toString=w;h.I.m=h;h.D=["South",1];h.D.toString=w;h.D.m=h;h.H=["East",2];h.H.toString=w;h.H.m=h;h.N=["West",3];h.N.toString=w;h.N.m=h;y.a=
!0;y.Cb=function(){return-1};y.vb=function(a){switch(a[1]){case 0:return h.D;case 1:return h.I;case 2:return h.N;case 3:return h.H}};y.prototype={Ya:function(a){return this.u.push(a)-1},J:function(a,c,b){this.ta(a)&&this.ta(c)?(this.u[a].J(c,b),this.u[c].J(a,y.vb(b))):G.log("Invalid connection created")},Ma:function(a){this.ta(a)||G.log("Invalid default room");return this.ja=a},ta:function(a){return 0<=a&&a<this.u.length},i:y};String.prototype.i=String;String.a=!0;Array.a=!0;var ma={a:["Int"]},na=
{a:["Dynamic"]},ka=Number;ka.a=["Float"];var la=Boolean;la.T=["Bool"];var oa={a:["Class"]},pa={};l.qb={}.toString;ga.Ta()})("undefined"!=typeof console?console:{log:function(){}});
